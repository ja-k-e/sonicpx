!function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=new(window.AudioContext||window.webkitAudioContext);t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cvs=document.createElement("canvas"),t&&t.appendChild(this.cvs),this.ctx=this.cvs.getContext("2d")}return a(e,[{key:"clear",value:function(){this.ctx.clearRect(0,0,this.w,this.h)}},{key:"setSize",value:function(e,t){this.w=e,this.wh=.5*e,this.h=t,this.hh=.5*t,this.cvs.width=e,this.cvs.height=t}},{key:"createImage",value:function(e,t){return this.ctx.createImageData(e,t)}},{key:"putImage",value:function(e,t,n){this.ctx.putImageData(e,t,n)}},{key:"drawImage",value:function(e,t,n){this.ctx.drawImage(e,0,0)}},{key:"imageData",value:function(e,t,n,a){return n=n||this.w,a=a||this.h,this.ctx.getImageData(e,t,n,a)}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(5),s=(a=r)&&a.__esModule?a:{default:a};var o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),i(t,[{key:"bits",get:function(){return 65536}}]),t}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(5),s=(a=r)&&a.__esModule?a:{default:a};var o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),i(t,[{key:"bits",get:function(){return 16777216}}]),t}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var i=function(){function e(t){var n=t.$element,a=t.stream,i=void 0!==a&&a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.stream=i,this.$element=n,this.$play=this.$element.querySelector(".play"),this.$progress=this.$element.querySelector(".progress > span")}return a(e,[{key:"bindPlay",value:function(e){var t=this;this.$play.addEventListener("click",function n(a){a.preventDefault();a.target.removeEventListener(a.type,n,!1);t.disable();e()},!1)}},{key:"enable",value:function(){this.$element.classList.remove("disabled")}},{key:"disable",value:function(){this.$element.classList.add("disabled")}},{key:"progress",value:function(e){this.stream?"start"===e?this.$element.classList.add("streaming"):"end"===e?this.$element.classList.add("complete"):(this.$element.classList.remove("streaming"),this.$element.classList.remove("complete")):this.$progress.style.width=100*e+"%"}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,[{key:"rgbStereo",value:function(e,t){return{rgbL:this.rgbMono(e).rgb,rgbR:this.rgbMono(t).rgb}}},{key:"rgbMono",value:function(e){var t=this._valToBytes(e),n=Math.floor(t/256/256);return{rgb:[n,Math.floor((t-256*n*256)/256),t%256]}}},{key:"valueStereo",value:function(e,t){return{valueL:this.valueMono(e).value,valueR:this.valueMono(t).value}}},{key:"valueMono",value:function(e){var t=256*e[0]*256+256*e[1]+e[2];return{value:this._bytesToVal(t)}}},{key:"_valToBytes",value:function(e){return e*this.bitsH+this.bitsH}},{key:"_bytesToVal",value:function(e){return e/this.bits*2-1}},{key:"bitsH",get:function(){return.5*this.bits}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var i=function(){function e(t){var n=t.accept,a=t.handleChange,i=t.$parent;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.handleChange=a,this.accept=n,this.$parent=i,this.initDOM()}return a(e,[{key:"disable",value:function(){this.$parent.classList.add("disabled")}},{key:"enable",value:function(){this.$parent.classList.remove("disabled")}},{key:"initDOM",value:function(){var e=this;this.$container=document.createElement("div"),this.$container.className="file-upload",this.$parent.appendChild(this.$container),this.$file=document.createElement("input"),this.$file.setAttribute("type","file"),this.$file.setAttribute("accept",this.accept),this.$file.setAttribute("required",""),this.$container.appendChild(this.$file),this.$container.addEventListener("dragover",function(){return e.$container.classList.add("is-active")}),this.$container.addEventListener("dragleave",function(){return e.$container.classList.remove("is-active")}),this.$file.addEventListener("change",function(){if(e.$parent.classList.remove("is-active"),e.$container.classList.remove("is-active"),e.$file.files&&e.$file.files[0]){var t=new FileReader,n=e.accept.replace(/\*/,""),a=e.$file.files[0];t.onload=function(t){t.target;e.$file.value=""},a&&a.type.match(n)?t.readAsDataURL(a):e.$file.value=""}else e.$file.value=""})}}]),e}();t.default=i},function(e,t,n){"use strict";var a,i=n(8),r=(a=i)&&a.__esModule?a:{default:a};console.info("\n%cSonicPX v0.1\n%cÂ© Jake Albaugh "+(new Date).getFullYear()+"\nhttps://twitter.com/jake_albaugh\nhttps://github.com/jakealbaugh/sonicpx\n\n","font-family: sans-serif; font-weight: bold;","font-family: sans-serif; font-weight: normal;"),new r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=o(n(9)),r=o(n(11)),s=o(n(13));function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.recordFile=new r.default,this.recordStream=new s.default,this.player=new i.default,this.initDOM(),this.processHash()}return a(e,[{key:"initDOM",value:function(){var e=this;this.$nav=document.querySelector("nav"),this.$navPlayer=this.$nav.querySelector("#nav-player"),this.$navFile=this.$nav.querySelector("#nav-file"),this.$navMic=this.$nav.querySelector("#nav-mic"),this.$player=document.body.querySelector("section#player"),this.$file=document.body.querySelector("section#file"),this.$mic=document.body.querySelector("section#mic"),this.$navPlayer.addEventListener("click",function(t){e.handleNav(t,e.$player)}),this.$navFile.addEventListener("click",function(t){e.handleNav(t,e.$file)}),this.$navMic.addEventListener("click",function(t){e.handleNav(t,e.$mic)}),window.addEventListener("hashchange",function(){e.processHash()})}},{key:"processHash",value:function(){var e=window.location.hash;"#player"===e?this.$navPlayer.click():"#file"===e?this.$navFile.click():"#mic"===e&&this.$navMic.click()}},{key:"handleNav",value:function(e,t){var n=this.$nav.querySelector("nav a.active"),a=document.querySelector("section.active");n&&n.classList.remove("active"),a&&a.classList.remove("active"),e.target.classList.add("active"),t.classList.add("active")}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=(o(n(0)),o(n(4))),r=(o(n(1)),o(n(10))),s=o(n(6));function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.audio=new i.default({$element:document.querySelector(".player .audio"),stream:!0}),this.file=new s.default({accept:"image/*",$parent:document.querySelector(".player .file"),handleChange:this.handleFileChange.bind(this)})}return a(e,[{key:"handleFileChange",value:function(e,t){var n=this;this.file.disable(),this.audio.progress("reset"),this.audio.disable(),this.converter&&this.converter.remove(),this.converter=new r.default,this.sized=new Image;var a=e.result;this.sized.onload=function(){n.converter.initialize(n.sized),n.audio.enable(),n.audio.bindPlay(n.handlePlay.bind(n))},this.sized.setAttribute("src",a)}},{key:"handlePlay",value:function(){var e=this;this.audio.progress("start"),this.converter.play(function(){return e.handleEnd()})}},{key:"handleEnd",value:function(){this.file.enable(),this.audio.progress("stop")}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=u(n(0)),r=u(n(1)),s=u(n(2)),o=u(n(3));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$parent=document.querySelector(".player .input")}return a(e,[{key:"remove",value:function(){this.$parent.innerHTML="",this.source.stop(),this.source.disconnect(i.default.destination),this._playing=!1,delete this.source}},{key:"play",value:function(e){this._playing||(this.source.onended=function(){return e()},this.source.start(),this._playing=!0)}},{key:"initialize",value:function(e){this.canvas=new r.default(this.$parent),this.canvas.setSize(e.width,e.height),this.canvas.drawImage(e,0,0),this.loadMeta(),this.initializeAudio()}},{key:"loadMeta",value:function(){var e=this.canvas.imageData(0,0,4,1).data;this._hasMeta(e)?(this.version=256*e[3]+e[7],this.stereo=1===e[11],this.bits=e[15]):(this.version=65536,this.stereo=!1,this.bits=16),this.adapter=16===this.bits?new s.default:new o.default}},{key:"_hasMeta",value:function(e){var t=!0;return[0,1,2,4,5,6,8,9,10,12,13,14].forEach(function(n){0!==e[n]&&(t=!1)}),e[11]>2&&(t=!1),16!==e[15]&&24!==e[15]&&(t=!1),t}},{key:"initializeAudio",value:function(){var e=this.canvas,t=e.w,n=e.wh,a=e.h;if(this.stereo){this.buffer=i.default.createBuffer(2,n*a,i.default.sampleRate);for(var r=this.canvas.imageData(0,1,n,a-1).data,s=this.canvas.imageData(n,1,n,a-1).data,o=this.buffer.getChannelData(0),u=this.buffer.getChannelData(1),c=r.length,l=0;l<c;l+=4){var f=Math.floor(l/4),h=r[l+0],d=r[l+1],v=r[l+2],p=r[l+3],y=s[l+0],m=s[l+1],b=s[l+2],g=s[l+3],w=this.adapter.valueStereo([h,d,v],[y,m,b]),k=w.valueL,$=w.valueR;255===p&&(o[f]=k),255===g&&(u[f]=$)}}else{this.buffer=i.default.createBuffer(1,t*a,i.default.sampleRate);var _=this.canvas.imageData(0,1,t,a-1).data,M=this.buffer.getChannelData(0),P=_.length;for(l=0;l<P;l+=4){var D=Math.floor(l/4),O=_[l+0],E=_[l+1],S=_[l+2],C=_[l+3],j=this.adapter.valueMono([O,E,S]).value;255===C&&(M[D]=j)}}this.source=i.default.createBufferSource(),this.source.buffer=this.buffer,this.source.connect(i.default.destination)}}]),e}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=u(n(0)),r=u(n(4)),s=u(n(12)),o=(u(n(1)),u(n(6)));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$output=document.querySelector(".recorder-file .output"),this.audio=new r.default({$element:document.querySelector(".recorder-file .audio")}),this.file=new o.default({accept:"audio/*",$parent:document.querySelector(".recorder-file .file"),handleChange:this.handleFileChange.bind(this)})}return a(e,[{key:"handleFileChange",value:function(e,t){var n=this;this.audio.progress(0),this.audio.disable(),this.file.disable(),this.element=new Audio,this.element.setAttribute("crossorigin","anonymous"),this.element.src=e.result,this.element.addEventListener("canplay",function(){n.element.duration<=30?(n.converter&&n.converter.remove(),n.audio.bindPlay(function(){n.initializeElement()}),n.audio.enable()):(n.file.enable(),alert("Will not process audio over 30 seconds long."))})}},{key:"initializeElement",value:function(){var e=this;this.stereo=document.querySelector("#stereo").checked,this._recordElement(),this.element.addEventListener("ended",function(){return e.converter.stop()})}},{key:"_recordElement",value:function(){var e=this;this.converter=new s.default({$parent:this.$output,duration:this.element.duration,bits:16,stereo:this.stereo}),this.input=i.default.createMediaElementSource(this.element);var t=this.stereo?2:1;this.processor=i.default.createScriptProcessor(8192,t,t),this.processor.onaudioprocess=function(t){e.audio.progress(e.element.currentTime/e.element.duration),e.converter.process(t)},this.input.connect(this.processor),this.input.connect(i.default.destination),this.element.onended=function(){e.audio.progress(1),e.file.enable(),e.converter.handleEnd(),e.input.disconnect(e.processor),e.input.disconnect(i.default.destination),e.processor.disconnect(i.default.destination),e.processor.onaudioprocess=null,delete e.element,delete e.input,delete e.processor},this.processor.connect(i.default.destination),this.element.play()}}]),e}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=u(n(0)),r=u(n(1)),s=u(n(2)),o=u(n(3));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t){var n=t.$parent,a=t.duration,i=t.bits,r=t.stereo,u=void 0===r||r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.bits=i,this.adapter=16===i?new s.default:new o.default,this.$parent=n,this.stereo=u,this.initialize(a),this.reset()}return a(e,[{key:"reset",value:function(){this.off=!1,this.tick=0,this.imageData=null}},{key:"initialize",value:function(e){this.canvasesIdx=0,this.canvases=[];for(var t=Math.ceil(e*i.default.sampleRate),n=Math.floor(Math.sqrt(t)),a=this.stereo?2*n:n,s=this.stereo?.5*a:a,o=Math.ceil(t/s),u=Math.ceil(e/5),c=Math.ceil(o/u),l=1===u?o:o-c*(u-1),f=0;f<u;f++){var h=new r.default(this.$parent),d=f===u-1?l:c;h.setSize(a,d),this.canvases.push(h)}}},{key:"remove",value:function(){this.$parent.innerHTML=""}},{key:"handleEnd",value:function(){this.canvas.putImage(this.imageData,0,0);var e=new r.default,t=this.canvases[0].w,n=this.canvases[0].h,a=this.canvases.map(function(e){return e.h}).reduce(function(e,t){return e+t});e.setSize(t,a+1);var i=(new r.default).createImage(4,1);i.data[3]=Math.floor(1/256),i.data[7]=1,i.data[11]=this.stereo?1:0,i.data[15]=this.bits,e.putImage(i,0,0);for(var s=0;s<this.canvases.length;s++){var o=s*n,u=this.canvases[s].imageData(0,0);e.putImage(u,0,o+1)}this.$parent.innerHTML="",this.$parent.appendChild(e.cvs)}},{key:"stop",value:function(){this.off=!0}},{key:"process",value:function(e){if(!this.off)if(this.imageData||(this.imageData=this.canvas.createImage(this.canvas.w,this.canvas.h)),this.stereo)for(var t=e.inputBuffer.getChannelData(0),n=e.inputBuffer.getChannelData(1),a=n.length,i=0;i<a;i++){if(this.off)return;var r=this.tickPosition(),s=r.x,o=r.y*this.canvas.w*4+4*s,u=o+4*this.canvas.wh,c=this.adapter.rgbStereo(t[i],n[i]),l=c.rgbL,f=c.rgbR;this.setDataAtIndex(o,l),this.setDataAtIndex(u,f),this.tick++}else for(var h=e.inputBuffer.getChannelData(0),d=h.length,v=0;v<d;v++){if(this.off)return;var p=this.tickPosition(),y=(s=p.x,p.y*this.canvas.w*4+4*s),m=this.adapter.rgbMono(h[v]).rgb;this.setDataAtIndex(y,m),this.tick++}}},{key:"setDataAtIndex",value:function(e,t){this.imageData.data[e+0]=t[0],this.imageData.data[e+1]=t[1],this.imageData.data[e+2]=t[2],this.imageData.data[e+3]=255}},{key:"tickPosition",value:function(){var e=this.stereo?this.canvas.wh:this.canvas.w,t=this.tick%e,n=Math.floor(this.tick/e);return n!==this.lastY&&n>this.canvas.h&&(this.canvas.putImage(this.imageData,0,0),this.nextCanvas(),this.imageData=this.canvas.createImage(this.canvas.w,this.canvas.h),this.tick=0),this.lastY=n,{x:t,y:n}}},{key:"nextCanvas",value:function(){this.canvasesIdx++}},{key:"canvas",get:function(){return this.canvases[this.canvasesIdx]}}]),e}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=s(n(0)),r=s(n(14));s(n(1));function s(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$output=document.querySelector(".recorder-mic .output"),this.recording=!1,this.started=!1,this.$toggle=document.querySelector("#record"),this.$toggle.addEventListener("click",function(){t.recording?t.stop():t.reset(),t.recording=!t.recording;var e=t.recording?"add":"remove";t.$toggle.classList[e]("active"),t.recording&&!t.started&&(t.started=!0,t.initializeStream().catch(function(){alert("Your device is not supported."),t.$toggle.classList.remove("active")}))})}return a(e,[{key:"reset",value:function(){this.converter&&this.converter.reset()}},{key:"stop",value:function(){this.converter.stop(),this.converter.handleEnd()}},{key:"initializeStream",value:function(){var e=this;return new Promise(function(t,n){navigator.mediaDevices?navigator.mediaDevices.getUserMedia({audio:!0}).then(function(n){t(),e._recordStream(n)}).catch(n):n("getUserMedia not supported!")})}},{key:"_recordStream",value:function(e){var t=this;this.converter=new r.default({$parent:this.$output,handleComplete:function(){t.$toggle.click()}}),this.input=i.default.createMediaStreamSource(e);this.processor=i.default.createScriptProcessor(8192,1,1),this.processor.onaudioprocess=function(e){t.converter.process(e)},this.input.connect(this.processor),this.input.onended=function(){t.input.disconnect(t.processor),t.processor.disconnect(i.default.destination),t.processor.onaudioprocess=null},this.processor.connect(i.default.destination)}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=o(n(0)),r=o(n(1)),s=o(n(2));o(n(3));function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){var n=t.$parent,a=t.handleComplete;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.handleComplete=a,this.adapter=new s.default,this.$parent=n,this.reset()}return a(e,[{key:"reset",value:function(){this.off=!1,this.tick=0,this.$parent.innerHTML="",this.canvas=new r.default(this.$parent);var e=Math.ceil(30*i.default.sampleRate/1200);this.canvas.setSize(1200,e),this.imageData=this.canvas.createImage(this.canvas.w,this.canvas.h)}},{key:"handleEnd",value:function(){var e=new r.default;e.setSize(this.canvas.w,this.lastY+1);var t=(new r.default).createImage(4,1);t.data[3]=Math.floor(1/256),t.data[7]=1,t.data[11]=0,t.data[15]=16,e.putImage(t,0,0);var n=this.canvas.imageData(0,0,this.canvas.w,this.lastY);e.putImage(n,0,1),this.$parent.innerHTML="",this.$parent.appendChild(e.cvs)}},{key:"stop",value:function(){this.off=!0}},{key:"process",value:function(e){if(!this.off)for(var t=e.inputBuffer.getChannelData(0),n=t.length,a=0;a<n;a++){if(this.off)return;var i=this.tickPosition(),r=i.x,s=i.y*this.canvas.w*4+4*r,o=this.adapter.rgbMono(t[a]).rgb;this.setDataAtIndex(s,o),this.tick++}}},{key:"setDataAtIndex",value:function(e,t){this.imageData.data[e+0]=t[0],this.imageData.data[e+1]=t[1],this.imageData.data[e+2]=t[2],this.imageData.data[e+3]=255}},{key:"tickPosition",value:function(){var e=this.canvas.w,t=this.tick%e,n=Math.floor(this.tick/e);return n%4==0&&n!==this.lastY&&(this.canvas.clear(),this.canvas.putImage(this.imageData,0,0)),n>this.canvas.h&&this.handleComplete(),this.lastY=n,{x:t,y:n}}}]),e}();t.default=u}]);